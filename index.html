<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>AI è‡ªåŠ¨è¯„è¯­æµ‹éªŒ</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background-color: #f4f7f6; }
        .container { max-width: 600px; margin: auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        h1 { color: #5B4FBB; text-align: center; }
        .question { margin-bottom: 20px; border: 1px solid #ddd; padding: 15px; border-radius: 5px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        textarea, input[type="number"] { width: 100%; padding: 10px; margin-top: 5px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        button { background-color: #7957D5; color: white; padding: 12px 20px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
        button:hover { background-color: #6C4DB7; }
        #message { margin-top: 15px; padding: 10px; border-radius: 4px; }
        .success { background-color: #D4EDDA; color: #155724; border: 1px solid #C3E6CB; }
        .error { background-color: #F8D7DA; color: #721C24; border: 1px solid #F5C6CB; }
    </style>
</head>
<body>
    <div class="container">
        <h1>U1 L1 Nice to meet you åœ¨çº¿æµ‹è¯•</h1>
        <form id="quizForm">
            
            <h2>Part 2: åœˆå‡ºä¸åŒç±» (æ¯é¢˜1åˆ†)</h2>
            <div class="question" data-id="P2Q1">
                <p>1. A. Mr. &nbsp;&nbsp;&nbsp;&nbsp; B. Sally &nbsp;&nbsp;&nbsp;&nbsp; C. Miss</p>
                <label><input type="radio" name="P2Q1" value="A"> A</label>
                <label><input type="radio" name="P2Q1" value="B"> B</label>
                <label><input type="radio" name="P2Q1" value="C"> C</label>
            </div>
            
            <div class="question" data-id="P2Q3">
                <p>2. A. I &nbsp;&nbsp;&nbsp;&nbsp; B. am &nbsp;&nbsp;&nbsp;&nbsp; C. you</p>
                <label><input type="radio" name="P2Q3" value="A"> A</label>
                <label><input type="radio" name="P2Q3" value="B"> B</label>
                <label><input type="radio" name="P2Q3" value="C"> C</label>
            </div>

            <h2>Part 3: æƒ…æ™¯äº¤é™… (æ¯é¢˜1åˆ†)</h2>
            <div class="question" data-id="P3Q1">
                <p>3. å¬åˆ° â€œNice to meet you.â€ æˆ‘ä»¬åº”å½“è¯´ (         )</p>
                <label><input type="radio" name="P3Q1" value="A"> A. Nice to meet you, too.</label>
                <label><input type="radio" name="P3Q1" value="B"> B. Iâ€™m banana.</label>
            </div>

            <div class="question" data-id="P3Q2">
                <p>4. ç‹æ¶›æƒ³å‘æ–°åŒå­¦ä»‹ç»è‡ªå·±æ—¶ï¼Œä»–åº”è¯¥è¯´ (         )</p>
                <label><input type="radio" name="P3Q2" value="A"> A. Hello, Iâ€™m Wang Tao.</label>
                <label><input type="radio" name="P3Q2" value="B"> B. Iâ€™m Wang Tao</label>
            </div>
            
            <label for="answer_raw">ğŸ“ ç®€ç­”/ä½œæ–‡ (AIè¯„è¯­çš„ä¾æ®):</label>
            <textarea id="answer_raw" name="Answer_Raw" rows="4" placeholder="ä¾‹å¦‚ï¼šæˆ‘è§‰å¾—è¿™äº›é¢˜å¾ˆç®€å•ï¼Œå…¨éƒ¨éƒ½åšå¯¹äº†ã€‚" required></textarea>

            <button type="submit">æäº¤å¹¶è·å– AI è¯„è¯­</button>
        </form>
        
        <div id="result"></div>
        <p id="message"></p>
    </div>

    <script>
        // ******************* æ‚¨çš„ Make.com Webhook URL *******************
        const WEBHOOK_URL = "https://hook.eu1.make.com/5nx5elyzjbbi8hujod7f4s6whmgthqc5"; // è¯·ç¡®ä¿è¿™é‡Œæ˜¯æ‚¨æœ€æ–°çš„ URL
        // *******************************************************************

        // è‡ªåŠ¨åˆ¤åˆ†çš„é€»è¾‘æ ¸å¿ƒï¼šæ­£ç¡®ç­”æ¡ˆ
        const CORRECT_ANSWERS = { 'P2Q1': 'B', 'P2Q3': 'B', 'P3Q1': 'A', 'P3Q2': 'A' }; // é”®ï¼šé¢˜ç›®IDï¼Œå€¼ï¼šæ­£ç¡®é€‰é¡¹
        const MAX_SCORE = Object.keys(CORRECT_ANSWERS).length; // ç†è®ºæœ€é«˜åˆ† (4é¢˜ x 1åˆ†/é¢˜)

        document.getElementById('quizForm').addEventListener('submit', function(event) {
            event.preventDefault(); 
            const form = event.target;
            const messageBox = document.getElementById('message');
            const resultDiv = document.getElementById('result');
            
            // 1. è·å–ç®€ç­”å†…å®¹
            const answerRaw = document.getElementById('answer_raw').value;

            // 2. è‡ªåŠ¨åˆ¤å®¢è§‚é¢˜å¾—åˆ†
            let studentScore = 0;
            for (const [questionId, correctAnswer] of Object.entries(CORRECT_ANSWERS)) {
                const selectedOption = form.elements[questionId].value;
                if (selectedOption === correctAnswer) {
                    studentScore += 1; // ç­”å¯¹ä¸€é¢˜åŠ  1 åˆ†
                }
            }

            // 3. æ˜¾ç¤ºå¾—åˆ†ç»“æœ
            resultDiv.innerHTML = `æ‚¨çš„å®¢è§‚é¢˜å¾—åˆ†: ${studentScore} / ${MAX_SCORE}`;
            
            // 4. å‡†å¤‡å‘é€ç»™ Make.com çš„æ•°æ®
            const dataToSend = {
                Answer_Raw: answerRaw, // åŒ…å«å­¦ç”Ÿå¡«å†™çš„ç®€ç­”ä½œæ–‡
                Score_Raw: studentScore // è‡ªåŠ¨åˆ¤åˆ†å¾—åˆ°çš„æ€»åˆ†
            };

            // 5. å‘é€æ•°æ®åˆ° Webhook
            messageBox.textContent = 'æ­£åœ¨å‘é€æ•°æ®åˆ° Make.com...';
            messageBox.className = '';

            fetch(WEBHOOK_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(dataToSend)
            })
            .then(response => {
                if (response.ok) {
                    messageBox.textContent = 'âœ… æäº¤æˆåŠŸï¼Make.com æµç¨‹å·²è§¦å‘ï¼ŒAI è¯„è¯­æ­£åœ¨ç”Ÿæˆä¸­...';
                    messageBox.className = 'success';
                } else {
                    // Make.com æµç¨‹å¯åŠ¨å¤±è´¥æ—¶
                    messageBox.textContent = 'âŒ æäº¤å¤±è´¥ï¼ŒMake.com Webhook è¿”å›é”™è¯¯ã€‚è¯·æ£€æŸ¥ Make.com æµç¨‹æ˜¯å¦å¼€å¯ã€‚';
                    messageBox.className = 'error';
                }
            })
            .catch(error => {
                // ç½‘ç»œè¯·æ±‚å¤±è´¥ï¼Œé€šå¸¸æ˜¯è¶…æ—¶æˆ– CodePen ç¯å¢ƒé—®é¢˜å¯¼è‡´çš„
                messageBox.textContent = 'âŒ ç½‘ç»œè¯·æ±‚å¤±è´¥ã€‚ä½†åå°å¯èƒ½å·²è¿è¡Œï¼Œè¯·æŸ¥çœ‹ Google Sheetsã€‚';
                messageBox.className = 'error';
                console.error('ç½‘ç»œè¯·æ±‚å¤±è´¥:', error);
            });
        });

    </script>
</body>
</html>
